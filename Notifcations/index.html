<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">

<!-- iPhone Fullscreen -->
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon.png">

<title>Notifications + Custom Sound</title>

<style>
body {
    margin: 0;
    background: #121212;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding-top: 80px;
}
button {
    padding: 15px 25px;
    font-size: 20px;
    border: none;
    border-radius: 10px;
    background: #744BFC;
    color: white;
    margin: 10px;
}
</style>
</head>
<body>

<h1>Send 5 Notifications + Custom Sound</h1>

<button id="ask">Enable Notifications</button>
<br>
<button id="send">Send 5 Notifications</button>

<!-- Audio element for custom sound -->
<audio id="notifSound" src="notification.mp3" preload="auto"></audio>

<script>
// Register Service Worker
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
}

// Request Notification Permission
document.getElementById("ask").onclick = async () => {
    const perm = await Notification.requestPermission();
    if (perm === "granted") {
        alert("Notifications Enabled!");
    } else {
        alert("Notifications Denied.");
    }
};

// Send 5 Notifications
document.getElementById("send").onclick = async () => {
    const reg = await navigator.serviceWorker.ready;
    const audio = document.getElementById("notifSound");

    for (let i = 1; i <= 5; i++) {

        // Play custom sound (foreground only)
        audio.currentTime = 0;
        audio.play().catch(e => console.log("Sound blocked", e));

        // Show notification (background uses default iOS sound)
        reg.showNotification(`Notification ${i}`, {
            body: `This is notification number ${i}`,
            icon: "icon.png",
            badge: "icon.png"
        });

        // Wait 2 seconds between notifications
        await new Promise(resolve => setTimeout(resolve, 2000));
    }
};
</script>

</body>
</html>
